{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/advising-dashboard-next/src/lib/db/schema.ts"],"sourcesContent":["import { pgTable, text, integer, timestamp, boolean, json, uuid, varchar } from 'drizzle-orm/pg-core';\nimport { relations } from 'drizzle-orm';\n\nexport const users = pgTable('users', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  email: varchar('email', { length: 255 }).notNull().unique(),\n  name: varchar('name', { length: 255 }).notNull(),\n  role: varchar('role', { length: 50 }).notNull().default('student'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\nexport const majors = pgTable('majors', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  code: varchar('code', { length: 50 }).notNull().unique(),\n  name: varchar('name', { length: 255 }).notNull(),\n  description: text('description'),\n  isActive: boolean('is_active').default(true).notNull(),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\nexport const advisorMajors = pgTable('advisor_majors', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  userId: uuid('user_id').notNull().references(() => users.id, { onDelete: 'cascade' }),\n  majorId: uuid('major_id').notNull().references(() => majors.id, { onDelete: 'cascade' }),\n});\n\nexport const courses = pgTable('courses', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  majorId: uuid('major_id').notNull().references(() => majors.id, { onDelete: 'cascade' }),\n  code: varchar('code', { length: 50 }).notNull(),\n  name: varchar('name', { length: 255 }).notNull(),\n  credits: integer('credits').notNull().default(3),\n  type: varchar('type', { length: 50 }).notNull().default('required'),\n  semester: integer('semester'),\n  offered: boolean('offered').default(true).notNull(),\n  prerequisites: json('prerequisites').$type<string[]>().default([]),\n  corequisites: json('corequisites').$type<string[]>().default([]),\n  concurrent: json('concurrent').$type<string[]>().default([]),\n  standingRequired: varchar('standing_required', { length: 50 }),\n  description: text('description'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\nexport const students = pgTable('students', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  studentId: varchar('student_id', { length: 50 }).notNull(),\n  majorId: uuid('major_id').notNull().references(() => majors.id, { onDelete: 'cascade' }),\n  userId: uuid('user_id').references(() => users.id),\n  name: varchar('name', { length: 255 }).notNull(),\n  email: varchar('email', { length: 255 }),\n  standing: varchar('standing', { length: 50 }),\n  creditsCompleted: integer('credits_completed').default(0),\n  creditsRegistered: integer('credits_registered').default(0),\n  creditsRemaining: integer('credits_remaining').default(0),\n  courseStatuses: json('course_statuses').$type<Record<string, string>>().default({}),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\nexport const advisingPeriods = pgTable('advising_periods', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  majorId: uuid('major_id').notNull().references(() => majors.id, { onDelete: 'cascade' }),\n  semester: varchar('semester', { length: 20 }).notNull(),\n  year: integer('year').notNull(),\n  advisorName: varchar('advisor_name', { length: 255 }),\n  isActive: boolean('is_active').default(true).notNull(),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n});\n\nexport const advisingSessions = pgTable('advising_sessions', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  periodId: uuid('period_id').notNull().references(() => advisingPeriods.id, { onDelete: 'cascade' }),\n  studentId: uuid('student_id').notNull().references(() => students.id, { onDelete: 'cascade' }),\n  advisorId: uuid('advisor_id').references(() => users.id),\n  advisedCourses: json('advised_courses').$type<string[]>().default([]),\n  optionalCourses: json('optional_courses').$type<string[]>().default([]),\n  repeatCourses: json('repeat_courses').$type<string[]>().default([]),\n  bypasses: json('bypasses').$type<Record<string, { note: string; advisor: string }>>().default({}),\n  note: text('note'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\nexport const usersRelations = relations(users, ({ many }) => ({\n  advisorMajors: many(advisorMajors),\n  advisingSessions: many(advisingSessions),\n}));\n\nexport const majorsRelations = relations(majors, ({ many }) => ({\n  courses: many(courses),\n  students: many(students),\n  advisorMajors: many(advisorMajors),\n  advisingPeriods: many(advisingPeriods),\n}));\n\nexport const coursesRelations = relations(courses, ({ one }) => ({\n  major: one(majors, {\n    fields: [courses.majorId],\n    references: [majors.id],\n  }),\n}));\n\nexport const studentsRelations = relations(students, ({ one, many }) => ({\n  major: one(majors, {\n    fields: [students.majorId],\n    references: [majors.id],\n  }),\n  user: one(users, {\n    fields: [students.userId],\n    references: [users.id],\n  }),\n  advisingSessions: many(advisingSessions),\n}));\n\nexport const advisingSessionsRelations = relations(advisingSessions, ({ one }) => ({\n  period: one(advisingPeriods, {\n    fields: [advisingSessions.periodId],\n    references: [advisingPeriods.id],\n  }),\n  student: one(students, {\n    fields: [advisingSessions.studentId],\n    references: [students.id],\n  }),\n  advisor: one(users, {\n    fields: [advisingSessions.advisorId],\n    references: [users.id],\n  }),\n}));\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 314, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/advising-dashboard-next/src/lib/db/index.ts"],"sourcesContent":["import { drizzle } from 'drizzle-orm/postgres-js';\nimport postgres from 'postgres';\nimport * as schema from './schema';\n\nconst connectionString = process.env.DATABASE_URL!;\n\nconst client = postgres(connectionString);\nexport const db = drizzle(client, { schema });\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEA,MAAM,mBAAmB,QAAQ,GAAG,CAAC,YAAY;AAEjD,MAAM,SAAS,IAAA,qJAAQ,EAAC;AACjB,MAAM,KAAK,IAAA,uKAAO,EAAC,QAAQ;IAAE,QAAA;AAAO"}},
    {"offset": {"line": 333, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 339, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/advising-dashboard-next/src/lib/eligibility/index.ts"],"sourcesContent":["import type { \n  Course, \n  Student, \n  EligibilityResult, \n  EligibilityStatus,\n  MutualConcurrentPair \n} from './types';\n\nexport * from './types';\n\nexport function getStudentStanding(totalCredits: number): string {\n  if (totalCredits >= 60) return 'Senior';\n  if (totalCredits >= 30) return 'Junior';\n  if (totalCredits >= 15) return 'Sophomore';\n  return 'Freshman';\n}\n\nexport function checkCourseCompleted(student: Student, courseCode: string): boolean {\n  const status = student.courseStatuses[courseCode];\n  return status?.toLowerCase() === 'c';\n}\n\nexport function checkCourseRegistered(student: Student, courseCode: string): boolean {\n  const status = student.courseStatuses[courseCode];\n  if (!status || status === '' || status.toLowerCase() === 'nan') {\n    return courseCode in student.courseStatuses;\n  }\n  const s = status.toLowerCase();\n  return s === 'r' || s === 'cr';\n}\n\nexport function checkCourseFailed(student: Student, courseCode: string): boolean {\n  const status = student.courseStatuses[courseCode];\n  return status?.toLowerCase() === 'f';\n}\n\nexport function checkCourseNotCompleted(student: Student, courseCode: string): boolean {\n  const status = student.courseStatuses[courseCode];\n  return status?.toLowerCase() === 'nc';\n}\n\nexport function parseRequirements(requirementStr: string | undefined | null): string[] {\n  if (!requirementStr || requirementStr === '') return [];\n  \n  const parts = requirementStr\n    .split(/[,;]|\\band\\b/i)\n    .map(p => p.trim())\n    .filter(p => p.length > 0);\n  \n  return parts;\n}\n\nexport function isCourseOffered(course: Course): boolean {\n  return course.offered === true;\n}\n\nexport function getMutualConcurrentPairs(courses: Course[]): MutualConcurrentPair[] {\n  const pairs: MutualConcurrentPair[] = [];\n  const seen = new Set<string>();\n  \n  for (const courseA of courses) {\n    for (const concurrentCode of courseA.concurrent) {\n      const courseB = courses.find(c => c.code === concurrentCode);\n      if (!courseB) continue;\n      \n      if (courseB.concurrent.includes(courseA.code)) {\n        const pairKey = [courseA.code, courseB.code].sort().join('|');\n        if (!seen.has(pairKey)) {\n          seen.add(pairKey);\n          pairs.push({\n            courseA: courseA.code,\n            courseB: courseB.code,\n          });\n        }\n      }\n    }\n  }\n  \n  return pairs;\n}\n\nexport function getCorequisiteAndConcurrentCourses(courses: Course[]): string[] {\n  const result = new Set<string>();\n  \n  for (const course of courses) {\n    if (course.corequisites.length > 0 || course.concurrent.length > 0) {\n      result.add(course.code);\n    }\n  }\n  \n  return Array.from(result);\n}\n\nfunction checkStandingRequirement(\n  student: Student,\n  standingRequired: string | undefined\n): { met: boolean; reason: string } {\n  if (!standingRequired) {\n    return { met: true, reason: '' };\n  }\n  \n  const totalCredits = student.creditsCompleted + student.creditsRegistered;\n  const studentStanding = getStudentStanding(totalCredits);\n  \n  const standingOrder = ['Freshman', 'Sophomore', 'Junior', 'Senior'];\n  const reqLower = standingRequired.toLowerCase();\n  \n  let requiredIndex = -1;\n  if (reqLower.includes('senior')) {\n    requiredIndex = standingOrder.indexOf('Senior');\n  } else if (reqLower.includes('junior')) {\n    requiredIndex = standingOrder.indexOf('Junior');\n  } else if (reqLower.includes('sophomore')) {\n    requiredIndex = standingOrder.indexOf('Sophomore');\n  }\n  \n  if (requiredIndex === -1) {\n    return { met: true, reason: '' };\n  }\n  \n  const studentIndex = standingOrder.indexOf(studentStanding);\n  \n  if (studentIndex >= requiredIndex) {\n    return { met: true, reason: '' };\n  }\n  \n  return { \n    met: false, \n    reason: `Requires ${standingOrder[requiredIndex]} standing (currently ${studentStanding})` \n  };\n}\n\nexport function checkEligibility(\n  student: Student,\n  courseCode: string,\n  advisedCourses: string[],\n  courses: Course[],\n  options: {\n    ignoreOffered?: boolean;\n    bypasses?: Record<string, { note: string; advisor: string }>;\n    simulateCourses?: string[];\n  } = {}\n): EligibilityResult {\n  const {\n    ignoreOffered = false,\n    bypasses = {},\n    simulateCourses = [],\n  } = options;\n  \n  const course = courses.find(c => c.code === courseCode);\n  \n  if (!course) {\n    return {\n      status: 'Not Eligible',\n      reason: 'Course not found in catalog',\n      missingPrerequisites: [],\n      missingConcurrent: [],\n      missingCorequisites: [],\n      standingIssue: false,\n      hasBypass: false,\n    };\n  }\n  \n  if (checkCourseCompleted(student, courseCode)) {\n    return {\n      status: 'Completed',\n      reason: 'Course already completed',\n      missingPrerequisites: [],\n      missingConcurrent: [],\n      missingCorequisites: [],\n      standingIssue: false,\n      hasBypass: false,\n    };\n  }\n  \n  if (checkCourseRegistered(student, courseCode)) {\n    return {\n      status: 'Registered',\n      reason: 'Currently registered for this course',\n      missingPrerequisites: [],\n      missingConcurrent: [],\n      missingCorequisites: [],\n      standingIssue: false,\n      hasBypass: false,\n    };\n  }\n  \n  if (advisedCourses.includes(courseCode)) {\n    return {\n      status: 'Advised',\n      reason: 'Course has been advised',\n      missingPrerequisites: [],\n      missingConcurrent: [],\n      missingCorequisites: [],\n      standingIssue: false,\n      hasBypass: false,\n    };\n  }\n  \n  if (bypasses[courseCode]) {\n    return {\n      status: 'Eligible',\n      reason: `Bypass granted: ${bypasses[courseCode].note}`,\n      missingPrerequisites: [],\n      missingConcurrent: [],\n      missingCorequisites: [],\n      standingIssue: false,\n      hasBypass: true,\n      bypassInfo: bypasses[courseCode],\n    };\n  }\n  \n  if (!ignoreOffered && !isCourseOffered(course)) {\n    return {\n      status: 'Not Eligible',\n      reason: 'Course is not offered this semester',\n      missingPrerequisites: [],\n      missingConcurrent: [],\n      missingCorequisites: [],\n      standingIssue: false,\n      hasBypass: false,\n    };\n  }\n  \n  const issues: string[] = [];\n  const missingPrerequisites: string[] = [];\n  const missingConcurrent: string[] = [];\n  const missingCorequisites: string[] = [];\n  let standingIssue = false;\n  \n  const standingCheck = checkStandingRequirement(student, course.standingRequired);\n  if (!standingCheck.met) {\n    issues.push(standingCheck.reason);\n    standingIssue = true;\n  }\n  \n  const mutualPairs = getMutualConcurrentPairs(courses);\n  const isMutualPairMember = mutualPairs.some(\n    pair => pair.courseA === courseCode || pair.courseB === courseCode\n  );\n  \n  const effectiveAdvised = [...advisedCourses, ...simulateCourses];\n  \n  for (const prereqCode of course.prerequisites) {\n    if (prereqCode.toLowerCase().includes('standing')) {\n      continue;\n    }\n    \n    const prereqCompleted = checkCourseCompleted(student, prereqCode);\n    const prereqRegistered = checkCourseRegistered(student, prereqCode);\n    const prereqAdvised = effectiveAdvised.includes(prereqCode);\n    const prereqBypassed = bypasses[prereqCode] !== undefined;\n    \n    if (prereqCompleted) {\n      continue;\n    }\n    \n    if (prereqRegistered) {\n      continue;\n    }\n    \n    if (prereqBypassed) {\n      continue;\n    }\n    \n    if (!prereqAdvised) {\n      missingPrerequisites.push(prereqCode);\n    }\n  }\n  \n  for (const concurrentCode of course.concurrent) {\n    if (isMutualPairMember) {\n      const isPairPartner = mutualPairs.some(\n        pair => \n          (pair.courseA === courseCode && pair.courseB === concurrentCode) ||\n          (pair.courseB === courseCode && pair.courseA === concurrentCode)\n      );\n      if (isPairPartner) {\n        continue;\n      }\n    }\n    \n    const concurrentCompleted = checkCourseCompleted(student, concurrentCode);\n    const concurrentRegistered = checkCourseRegistered(student, concurrentCode);\n    const concurrentAdvised = effectiveAdvised.includes(concurrentCode);\n    const concurrentBypassed = bypasses[concurrentCode] !== undefined;\n    \n    if (concurrentCompleted || concurrentRegistered || concurrentAdvised || concurrentBypassed) {\n      continue;\n    }\n    \n    missingConcurrent.push(concurrentCode);\n  }\n  \n  for (const coreqCode of course.corequisites) {\n    const coreqCompleted = checkCourseCompleted(student, coreqCode);\n    const coreqRegistered = checkCourseRegistered(student, coreqCode);\n    const coreqAdvised = effectiveAdvised.includes(coreqCode);\n    const coreqBypassed = bypasses[coreqCode] !== undefined;\n    \n    if (coreqCompleted || coreqRegistered || coreqAdvised || coreqBypassed) {\n      continue;\n    }\n    \n    missingCorequisites.push(coreqCode);\n  }\n  \n  if (missingPrerequisites.length > 0) {\n    issues.push(`Missing prerequisites: ${missingPrerequisites.join(', ')}`);\n  }\n  \n  if (missingConcurrent.length > 0) {\n    issues.push(`Missing concurrent courses: ${missingConcurrent.join(', ')}`);\n  }\n  \n  if (missingCorequisites.length > 0) {\n    issues.push(`Missing corequisites: ${missingCorequisites.join(', ')}`);\n  }\n  \n  if (issues.length === 0) {\n    return {\n      status: 'Eligible',\n      reason: 'All requirements met',\n      missingPrerequisites: [],\n      missingConcurrent: [],\n      missingCorequisites: [],\n      standingIssue: false,\n      hasBypass: false,\n    };\n  }\n  \n  return {\n    status: 'Not Eligible',\n    reason: issues.join('; '),\n    missingPrerequisites,\n    missingConcurrent,\n    missingCorequisites,\n    standingIssue,\n    hasBypass: false,\n  };\n}\n\nexport function getEligibleCourses(\n  student: Student,\n  courses: Course[],\n  advisedCourses: string[] = [],\n  options: {\n    bypasses?: Record<string, { note: string; advisor: string }>;\n    excludeCodes?: string[];\n  } = {}\n): { course: Course; eligibility: EligibilityResult }[] {\n  const { bypasses = {}, excludeCodes = [] } = options;\n  \n  const results: { course: Course; eligibility: EligibilityResult }[] = [];\n  \n  for (const course of courses) {\n    if (excludeCodes.includes(course.code)) {\n      continue;\n    }\n    \n    const eligibility = checkEligibility(\n      student,\n      course.code,\n      advisedCourses,\n      courses,\n      { bypasses }\n    );\n    \n    if (eligibility.status === 'Eligible') {\n      results.push({ course, eligibility });\n    }\n  }\n  \n  return results;\n}\n\nexport function getAllCoursesWithEligibility(\n  student: Student,\n  courses: Course[],\n  advisedCourses: string[] = [],\n  options: {\n    bypasses?: Record<string, { note: string; advisor: string }>;\n    excludeCodes?: string[];\n  } = {}\n): { course: Course; eligibility: EligibilityResult }[] {\n  const { bypasses = {}, excludeCodes = [] } = options;\n  \n  return courses\n    .filter(course => !excludeCodes.includes(course.code))\n    .map(course => ({\n      course,\n      eligibility: checkEligibility(\n        student,\n        course.code,\n        advisedCourses,\n        courses,\n        { bypasses }\n      ),\n    }));\n}\n\nexport function calculateCurriculumYears(courses: Course[]): Record<string, number> {\n  const courseYears: Record<string, number> = {};\n  const prereqMap: Record<string, string[]> = {};\n  const standingReqs: Record<string, string | undefined> = {};\n  \n  for (const course of courses) {\n    const coursePrereqs: string[] = [];\n    let standingReq: string | undefined;\n    \n    for (const prereq of course.prerequisites) {\n      if (prereq.toLowerCase().includes('standing')) {\n        standingReq = prereq;\n      } else {\n        coursePrereqs.push(prereq);\n      }\n    }\n    \n    prereqMap[course.code] = coursePrereqs;\n    standingReqs[course.code] = standingReq;\n  }\n  \n  function getCourseYear(courseCode: string, visited: Set<string> = new Set()): number {\n    if (courseYears[courseCode] !== undefined) {\n      return courseYears[courseCode];\n    }\n    \n    if (visited.has(courseCode)) {\n      return 1;\n    }\n    \n    visited.add(courseCode);\n    \n    const prereqs = prereqMap[courseCode] || [];\n    const standingReq = standingReqs[courseCode];\n    \n    let maxPrereqYear = 0;\n    for (const prereqCode of prereqs) {\n      if (prereqMap[prereqCode] !== undefined) {\n        const prereqYear = getCourseYear(prereqCode, new Set(visited));\n        maxPrereqYear = Math.max(maxPrereqYear, prereqYear);\n      }\n    }\n    \n    let standingYear = 1;\n    if (standingReq) {\n      if (standingReq.toLowerCase().includes('senior')) {\n        standingYear = 3;\n      } else if (standingReq.toLowerCase().includes('junior')) {\n        standingYear = 2;\n      }\n    }\n    \n    const courseYear = Math.max(maxPrereqYear + 1, standingYear);\n    courseYears[courseCode] = courseYear;\n    return courseYear;\n  }\n  \n  for (const courseCode of Object.keys(prereqMap)) {\n    getCourseYear(courseCode);\n  }\n  \n  return courseYears;\n}\n\nexport function getCoursesNeedingRepeat(student: Student, courses: Course[]): Course[] {\n  return courses.filter(course => checkCourseFailed(student, course.code));\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 729, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/advising-dashboard-next/src/app/api/eligibility/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { db } from '@/lib/db';\nimport { courses, students, advisingSessions, advisingPeriods } from '@/lib/db/schema';\nimport { eq, and, desc } from 'drizzle-orm';\nimport { \n  checkEligibility, \n  getAllCoursesWithEligibility,\n  getStudentStanding,\n  type Course as EligibilityCourse,\n  type Student as EligibilityStudent\n} from '@/lib/eligibility';\n\nfunction dbCourseToEligibilityCourse(dbCourse: typeof courses.$inferSelect): EligibilityCourse {\n  return {\n    id: dbCourse.id,\n    code: dbCourse.code,\n    name: dbCourse.name,\n    credits: dbCourse.credits,\n    type: dbCourse.type as 'required' | 'intensive' | 'elective',\n    semester: dbCourse.semester ?? undefined,\n    offered: dbCourse.offered,\n    prerequisites: (dbCourse.prerequisites as string[]) || [],\n    corequisites: (dbCourse.corequisites as string[]) || [],\n    concurrent: (dbCourse.concurrent as string[]) || [],\n    standingRequired: dbCourse.standingRequired ?? undefined,\n    description: dbCourse.description ?? undefined,\n  };\n}\n\nfunction dbStudentToEligibilityStudent(dbStudent: typeof students.$inferSelect): EligibilityStudent {\n  const totalCredits = (dbStudent.creditsCompleted || 0) + (dbStudent.creditsRegistered || 0);\n  return {\n    id: dbStudent.id,\n    studentId: dbStudent.studentId,\n    name: dbStudent.name,\n    email: dbStudent.email ?? undefined,\n    standing: dbStudent.standing || getStudentStanding(totalCredits),\n    creditsCompleted: dbStudent.creditsCompleted || 0,\n    creditsRegistered: dbStudent.creditsRegistered || 0,\n    creditsRemaining: dbStudent.creditsRemaining || 0,\n    courseStatuses: (dbStudent.courseStatuses as Record<string, string>) || {},\n  };\n}\n\nexport async function GET(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const studentId = searchParams.get('studentId');\n    const majorId = searchParams.get('majorId');\n    const periodId = searchParams.get('periodId');\n    \n    if (!studentId || !majorId) {\n      return NextResponse.json({ error: 'studentId and majorId are required' }, { status: 400 });\n    }\n    \n    const studentResult = await db.select().from(students).where(eq(students.id, studentId));\n    if (studentResult.length === 0) {\n      return NextResponse.json({ error: 'Student not found' }, { status: 404 });\n    }\n    \n    const coursesResult = await db.select().from(courses).where(eq(courses.majorId, majorId));\n    \n    let session = null;\n    if (periodId) {\n      const sessionResult = await db.select()\n        .from(advisingSessions)\n        .where(and(\n          eq(advisingSessions.studentId, studentId),\n          eq(advisingSessions.periodId, periodId)\n        ))\n        .orderBy(desc(advisingSessions.updatedAt))\n        .limit(1);\n      \n      if (sessionResult.length > 0) {\n        session = sessionResult[0];\n      }\n    }\n    \n    const student = dbStudentToEligibilityStudent(studentResult[0]);\n    const courseList = coursesResult.map(dbCourseToEligibilityCourse);\n    \n    const advisedCourses = session?.advisedCourses as string[] || [];\n    const optionalCourses = session?.optionalCourses as string[] || [];\n    const repeatCourses = session?.repeatCourses as string[] || [];\n    const bypasses = session?.bypasses as Record<string, { note: string; advisor: string }> || {};\n    \n    const allAdvised = [...advisedCourses, ...optionalCourses, ...repeatCourses];\n    \n    const eligibilityResults = getAllCoursesWithEligibility(\n      student,\n      courseList,\n      allAdvised,\n      { bypasses }\n    );\n    \n    return NextResponse.json({\n      student,\n      courses: eligibilityResults,\n      session: session ? {\n        id: session.id,\n        advisedCourses,\n        optionalCourses,\n        repeatCourses,\n        bypasses,\n        note: session.note,\n      } : null,\n    });\n  } catch (error) {\n    console.error('Error checking eligibility:', error);\n    return NextResponse.json({ error: 'Failed to check eligibility' }, { status: 500 });\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const { studentId, courseCode, majorId, advisedCourses = [], bypasses = {} } = body;\n    \n    if (!studentId || !courseCode || !majorId) {\n      return NextResponse.json({ error: 'studentId, courseCode, and majorId are required' }, { status: 400 });\n    }\n    \n    const studentResult = await db.select().from(students).where(eq(students.id, studentId));\n    if (studentResult.length === 0) {\n      return NextResponse.json({ error: 'Student not found' }, { status: 404 });\n    }\n    \n    const coursesResult = await db.select().from(courses).where(eq(courses.majorId, majorId));\n    \n    const student = dbStudentToEligibilityStudent(studentResult[0]);\n    const courseList = coursesResult.map(dbCourseToEligibilityCourse);\n    \n    const result = checkEligibility(\n      student,\n      courseCode,\n      advisedCourses,\n      courseList,\n      { bypasses }\n    );\n    \n    return NextResponse.json(result);\n  } catch (error) {\n    console.error('Error checking single course eligibility:', error);\n    return NextResponse.json({ error: 'Failed to check eligibility' }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":"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"}}]
}