{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/advising-dashboard-next/src/lib/db/schema.ts"],"sourcesContent":["import { pgTable, text, integer, timestamp, boolean, json, uuid, varchar } from 'drizzle-orm/pg-core';\nimport { relations } from 'drizzle-orm';\n\nexport const users = pgTable('users', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  email: varchar('email', { length: 255 }).notNull().unique(),\n  name: varchar('name', { length: 255 }).notNull(),\n  role: varchar('role', { length: 50 }).notNull().default('student'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\nexport const majors = pgTable('majors', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  code: varchar('code', { length: 50 }).notNull().unique(),\n  name: varchar('name', { length: 255 }).notNull(),\n  description: text('description'),\n  isActive: boolean('is_active').default(true).notNull(),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\nexport const advisorMajors = pgTable('advisor_majors', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  userId: uuid('user_id').notNull().references(() => users.id, { onDelete: 'cascade' }),\n  majorId: uuid('major_id').notNull().references(() => majors.id, { onDelete: 'cascade' }),\n});\n\nexport const courses = pgTable('courses', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  majorId: uuid('major_id').notNull().references(() => majors.id, { onDelete: 'cascade' }),\n  code: varchar('code', { length: 50 }).notNull(),\n  name: varchar('name', { length: 255 }).notNull(),\n  credits: integer('credits').notNull().default(3),\n  type: varchar('type', { length: 50 }).notNull().default('required'),\n  semester: integer('semester'),\n  offered: boolean('offered').default(true).notNull(),\n  prerequisites: json('prerequisites').$type<string[]>().default([]),\n  corequisites: json('corequisites').$type<string[]>().default([]),\n  concurrent: json('concurrent').$type<string[]>().default([]),\n  standingRequired: varchar('standing_required', { length: 50 }),\n  description: text('description'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\nexport const students = pgTable('students', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  studentId: varchar('student_id', { length: 50 }).notNull(),\n  majorId: uuid('major_id').notNull().references(() => majors.id, { onDelete: 'cascade' }),\n  userId: uuid('user_id').references(() => users.id),\n  name: varchar('name', { length: 255 }).notNull(),\n  email: varchar('email', { length: 255 }),\n  standing: varchar('standing', { length: 50 }),\n  creditsCompleted: integer('credits_completed').default(0),\n  creditsRegistered: integer('credits_registered').default(0),\n  creditsRemaining: integer('credits_remaining').default(0),\n  courseStatuses: json('course_statuses').$type<Record<string, string>>().default({}),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\nexport const advisingPeriods = pgTable('advising_periods', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  majorId: uuid('major_id').notNull().references(() => majors.id, { onDelete: 'cascade' }),\n  semester: varchar('semester', { length: 20 }).notNull(),\n  year: integer('year').notNull(),\n  advisorName: varchar('advisor_name', { length: 255 }),\n  isActive: boolean('is_active').default(true).notNull(),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n});\n\nexport const advisingSessions = pgTable('advising_sessions', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  periodId: uuid('period_id').notNull().references(() => advisingPeriods.id, { onDelete: 'cascade' }),\n  studentId: uuid('student_id').notNull().references(() => students.id, { onDelete: 'cascade' }),\n  advisorId: uuid('advisor_id').references(() => users.id),\n  advisedCourses: json('advised_courses').$type<string[]>().default([]),\n  optionalCourses: json('optional_courses').$type<string[]>().default([]),\n  repeatCourses: json('repeat_courses').$type<string[]>().default([]),\n  bypasses: json('bypasses').$type<Record<string, { note: string; advisor: string }>>().default({}),\n  note: text('note'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\nexport const settings = pgTable('settings', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  key: varchar('key', { length: 100 }).notNull().unique(),\n  value: json('value').$type<Record<string, unknown>>().default({}),\n  category: varchar('category', { length: 50 }).notNull().default('general'),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\nexport const advisingPlans = pgTable('advising_plans', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  studentId: uuid('student_id').notNull().references(() => students.id, { onDelete: 'cascade' }),\n  periodId: uuid('period_id').references(() => advisingPeriods.id, { onDelete: 'set null' }),\n  termName: varchar('term_name', { length: 50 }).notNull(),\n  termSequence: integer('term_sequence').notNull(),\n  plannedCourses: json('planned_courses').$type<string[]>().default([]),\n  notes: text('notes'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\nexport const emailLogs = pgTable('email_logs', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  studentId: uuid('student_id').references(() => students.id, { onDelete: 'set null' }),\n  advisorId: uuid('advisor_id').references(() => users.id, { onDelete: 'set null' }),\n  recipientEmail: varchar('recipient_email', { length: 255 }).notNull(),\n  subject: varchar('subject', { length: 255 }).notNull(),\n  body: text('body').notNull(),\n  templateUsed: varchar('template_used', { length: 100 }),\n  status: varchar('status', { length: 20 }).notNull().default('sent'),\n  sentAt: timestamp('sent_at').defaultNow().notNull(),\n});\n\nexport const emailTemplates = pgTable('email_templates', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  name: varchar('name', { length: 100 }).notNull().unique(),\n  subject: varchar('subject', { length: 255 }).notNull(),\n  body: text('body').notNull(),\n  category: varchar('category', { length: 50 }).notNull().default('general'),\n  isActive: boolean('is_active').default(true).notNull(),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\nexport const usersRelations = relations(users, ({ many }) => ({\n  advisorMajors: many(advisorMajors),\n  advisingSessions: many(advisingSessions),\n}));\n\nexport const majorsRelations = relations(majors, ({ many }) => ({\n  courses: many(courses),\n  students: many(students),\n  advisorMajors: many(advisorMajors),\n  advisingPeriods: many(advisingPeriods),\n}));\n\nexport const coursesRelations = relations(courses, ({ one }) => ({\n  major: one(majors, {\n    fields: [courses.majorId],\n    references: [majors.id],\n  }),\n}));\n\nexport const studentsRelations = relations(students, ({ one, many }) => ({\n  major: one(majors, {\n    fields: [students.majorId],\n    references: [majors.id],\n  }),\n  user: one(users, {\n    fields: [students.userId],\n    references: [users.id],\n  }),\n  advisingSessions: many(advisingSessions),\n}));\n\nexport const advisingSessionsRelations = relations(advisingSessions, ({ one }) => ({\n  period: one(advisingPeriods, {\n    fields: [advisingSessions.periodId],\n    references: [advisingPeriods.id],\n  }),\n  student: one(students, {\n    fields: [advisingSessions.studentId],\n    references: [students.id],\n  }),\n  advisor: one(users, {\n    fields: [advisingSessions.advisorId],\n    references: [users.id],\n  }),\n}));\n\nexport const advisingPlansRelations = relations(advisingPlans, ({ one }) => ({\n  student: one(students, {\n    fields: [advisingPlans.studentId],\n    references: [students.id],\n  }),\n  period: one(advisingPeriods, {\n    fields: [advisingPlans.periodId],\n    references: [advisingPeriods.id],\n  }),\n}));\n\nexport const emailLogsRelations = relations(emailLogs, ({ one }) => ({\n  student: one(students, {\n    fields: [emailLogs.studentId],\n    references: [students.id],\n  }),\n  advisor: one(users, {\n    fields: [emailLogs.advisorId],\n    references: [users.id],\n  }),\n}));\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;AAEO,MAAM,QAAQ,IAAA,mMAAO,EAAC,SAAS;IACpC,IAAI,IAAA,0MAAI,EAAC,MAAM,UAAU,GAAG,aAAa;IACzC,OAAO,IAAA,gNAAO,EAAC,SAAS;QAAE,QAAQ;IAAI,GAAG,OAAO,GAAG,MAAM;IACzD,MAAM,IAAA,gNAAO,EAAC,QAAQ;QAAE,QAAQ;IAAI,GAAG,OAAO;IAC9C,MAAM,IAAA,gNAAO,EAAC,QAAQ;QAAE,QAAQ;IAAG,GAAG,OAAO,GAAG,OAAO,CAAC;IACxD,WAAW,IAAA,oNAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,oNAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAEO,MAAM,SAAS,IAAA,mMAAO,EAAC,UAAU;IACtC,IAAI,IAAA,0MAAI,EAAC,MAAM,UAAU,GAAG,aAAa;IACzC,MAAM,IAAA,gNAAO,EAAC,QAAQ;QAAE,QAAQ;IAAG,GAAG,OAAO,GAAG,MAAM;IACtD,MAAM,IAAA,gNAAO,EAAC,QAAQ;QAAE,QAAQ;IAAI,GAAG,OAAO;IAC9C,aAAa,IAAA,0MAAI,EAAC;IAClB,UAAU,IAAA,gNAAO,EAAC,aAAa,OAAO,CAAC,MAAM,OAAO;IACpD,WAAW,IAAA,oNAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,oNAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAEO,MAAM,gBAAgB,IAAA,mMAAO,EAAC,kBAAkB;IACrD,IAAI,IAAA,0MAAI,EAAC,MAAM,UAAU,GAAG,aAAa;IACzC,QAAQ,IAAA,0MAAI,EAAC,WAAW,OAAO,GAAG,UAAU,CAAC,IAAM,MAAM,EAAE,EAAE;QAAE,UAAU;IAAU;IACnF,SAAS,IAAA,0MAAI,EAAC,YAAY,OAAO,GAAG,UAAU,CAAC,IAAM,OAAO,EAAE,EAAE;QAAE,UAAU;IAAU;AACxF;AAEO,MAAM,UAAU,IAAA,mMAAO,EAAC,WAAW;IACxC,IAAI,IAAA,0MAAI,EAAC,MAAM,UAAU,GAAG,aAAa;IACzC,SAAS,IAAA,0MAAI,EAAC,YAAY,OAAO,GAAG,UAAU,CAAC,IAAM,OAAO,EAAE,EAAE;QAAE,UAAU;IAAU;IACtF,MAAM,IAAA,gNAAO,EAAC,QAAQ;QAAE,QAAQ;IAAG,GAAG,OAAO;IAC7C,MAAM,IAAA,gNAAO,EAAC,QAAQ;QAAE,QAAQ;IAAI,GAAG,OAAO;IAC9C,SAAS,IAAA,gNAAO,EAAC,WAAW,OAAO,GAAG,OAAO,CAAC;IAC9C,MAAM,IAAA,gNAAO,EAAC,QAAQ;QAAE,QAAQ;IAAG,GAAG,OAAO,GAAG,OAAO,CAAC;IACxD,UAAU,IAAA,gNAAO,EAAC;IAClB,SAAS,IAAA,gNAAO,EAAC,WAAW,OAAO,CAAC,MAAM,OAAO;IACjD,eAAe,IAAA,0MAAI,EAAC,iBAAiB,KAAK,GAAa,OAAO,CAAC,EAAE;IACjE,cAAc,IAAA,0MAAI,EAAC,gBAAgB,KAAK,GAAa,OAAO,CAAC,EAAE;IAC/D,YAAY,IAAA,0MAAI,EAAC,cAAc,KAAK,GAAa,OAAO,CAAC,EAAE;IAC3D,kBAAkB,IAAA,gNAAO,EAAC,qBAAqB;QAAE,QAAQ;IAAG;IAC5D,aAAa,IAAA,0MAAI,EAAC;IAClB,WAAW,IAAA,oNAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,oNAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAEO,MAAM,WAAW,IAAA,mMAAO,EAAC,YAAY;IAC1C,IAAI,IAAA,0MAAI,EAAC,MAAM,UAAU,GAAG,aAAa;IACzC,WAAW,IAAA,gNAAO,EAAC,cAAc;QAAE,QAAQ;IAAG,GAAG,OAAO;IACxD,SAAS,IAAA,0MAAI,EAAC,YAAY,OAAO,GAAG,UAAU,CAAC,IAAM,OAAO,EAAE,EAAE;QAAE,UAAU;IAAU;IACtF,QAAQ,IAAA,0MAAI,EAAC,WAAW,UAAU,CAAC,IAAM,MAAM,EAAE;IACjD,MAAM,IAAA,gNAAO,EAAC,QAAQ;QAAE,QAAQ;IAAI,GAAG,OAAO;IAC9C,OAAO,IAAA,gNAAO,EAAC,SAAS;QAAE,QAAQ;IAAI;IACtC,UAAU,IAAA,gNAAO,EAAC,YAAY;QAAE,QAAQ;IAAG;IAC3C,kBAAkB,IAAA,gNAAO,EAAC,qBAAqB,OAAO,CAAC;IACvD,mBAAmB,IAAA,gNAAO,EAAC,sBAAsB,OAAO,CAAC;IACzD,kBAAkB,IAAA,gNAAO,EAAC,qBAAqB,OAAO,CAAC;IACvD,gBAAgB,IAAA,0MAAI,EAAC,mBAAmB,KAAK,GAA2B,OAAO,CAAC,CAAC;IACjF,WAAW,IAAA,oNAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,oNAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAEO,MAAM,kBAAkB,IAAA,mMAAO,EAAC,oBAAoB;IACzD,IAAI,IAAA,0MAAI,EAAC,MAAM,UAAU,GAAG,aAAa;IACzC,SAAS,IAAA,0MAAI,EAAC,YAAY,OAAO,GAAG,UAAU,CAAC,IAAM,OAAO,EAAE,EAAE;QAAE,UAAU;IAAU;IACtF,UAAU,IAAA,gNAAO,EAAC,YAAY;QAAE,QAAQ;IAAG,GAAG,OAAO;IACrD,MAAM,IAAA,gNAAO,EAAC,QAAQ,OAAO;IAC7B,aAAa,IAAA,gNAAO,EAAC,gBAAgB;QAAE,QAAQ;IAAI;IACnD,UAAU,IAAA,gNAAO,EAAC,aAAa,OAAO,CAAC,MAAM,OAAO;IACpD,WAAW,IAAA,oNAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAEO,MAAM,mBAAmB,IAAA,mMAAO,EAAC,qBAAqB;IAC3D,IAAI,IAAA,0MAAI,EAAC,MAAM,UAAU,GAAG,aAAa;IACzC,UAAU,IAAA,0MAAI,EAAC,aAAa,OAAO,GAAG,UAAU,CAAC,IAAM,gBAAgB,EAAE,EAAE;QAAE,UAAU;IAAU;IACjG,WAAW,IAAA,0MAAI,EAAC,cAAc,OAAO,GAAG,UAAU,CAAC,IAAM,SAAS,EAAE,EAAE;QAAE,UAAU;IAAU;IAC5F,WAAW,IAAA,0MAAI,EAAC,cAAc,UAAU,CAAC,IAAM,MAAM,EAAE;IACvD,gBAAgB,IAAA,0MAAI,EAAC,mBAAmB,KAAK,GAAa,OAAO,CAAC,EAAE;IACpE,iBAAiB,IAAA,0MAAI,EAAC,oBAAoB,KAAK,GAAa,OAAO,CAAC,EAAE;IACtE,eAAe,IAAA,0MAAI,EAAC,kBAAkB,KAAK,GAAa,OAAO,CAAC,EAAE;IAClE,UAAU,IAAA,0MAAI,EAAC,YAAY,KAAK,GAAsD,OAAO,CAAC,CAAC;IAC/F,MAAM,IAAA,0MAAI,EAAC;IACX,WAAW,IAAA,oNAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,oNAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAEO,MAAM,WAAW,IAAA,mMAAO,EAAC,YAAY;IAC1C,IAAI,IAAA,0MAAI,EAAC,MAAM,UAAU,GAAG,aAAa;IACzC,KAAK,IAAA,gNAAO,EAAC,OAAO;QAAE,QAAQ;IAAI,GAAG,OAAO,GAAG,MAAM;IACrD,OAAO,IAAA,0MAAI,EAAC,SAAS,KAAK,GAA4B,OAAO,CAAC,CAAC;IAC/D,UAAU,IAAA,gNAAO,EAAC,YAAY;QAAE,QAAQ;IAAG,GAAG,OAAO,GAAG,OAAO,CAAC;IAChE,WAAW,IAAA,oNAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAEO,MAAM,gBAAgB,IAAA,mMAAO,EAAC,kBAAkB;IACrD,IAAI,IAAA,0MAAI,EAAC,MAAM,UAAU,GAAG,aAAa;IACzC,WAAW,IAAA,0MAAI,EAAC,cAAc,OAAO,GAAG,UAAU,CAAC,IAAM,SAAS,EAAE,EAAE;QAAE,UAAU;IAAU;IAC5F,UAAU,IAAA,0MAAI,EAAC,aAAa,UAAU,CAAC,IAAM,gBAAgB,EAAE,EAAE;QAAE,UAAU;IAAW;IACxF,UAAU,IAAA,gNAAO,EAAC,aAAa;QAAE,QAAQ;IAAG,GAAG,OAAO;IACtD,cAAc,IAAA,gNAAO,EAAC,iBAAiB,OAAO;IAC9C,gBAAgB,IAAA,0MAAI,EAAC,mBAAmB,KAAK,GAAa,OAAO,CAAC,EAAE;IACpE,OAAO,IAAA,0MAAI,EAAC;IACZ,WAAW,IAAA,oNAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,oNAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAEO,MAAM,YAAY,IAAA,mMAAO,EAAC,cAAc;IAC7C,IAAI,IAAA,0MAAI,EAAC,MAAM,UAAU,GAAG,aAAa;IACzC,WAAW,IAAA,0MAAI,EAAC,cAAc,UAAU,CAAC,IAAM,SAAS,EAAE,EAAE;QAAE,UAAU;IAAW;IACnF,WAAW,IAAA,0MAAI,EAAC,cAAc,UAAU,CAAC,IAAM,MAAM,EAAE,EAAE;QAAE,UAAU;IAAW;IAChF,gBAAgB,IAAA,gNAAO,EAAC,mBAAmB;QAAE,QAAQ;IAAI,GAAG,OAAO;IACnE,SAAS,IAAA,gNAAO,EAAC,WAAW;QAAE,QAAQ;IAAI,GAAG,OAAO;IACpD,MAAM,IAAA,0MAAI,EAAC,QAAQ,OAAO;IAC1B,cAAc,IAAA,gNAAO,EAAC,iBAAiB;QAAE,QAAQ;IAAI;IACrD,QAAQ,IAAA,gNAAO,EAAC,UAAU;QAAE,QAAQ;IAAG,GAAG,OAAO,GAAG,OAAO,CAAC;IAC5D,QAAQ,IAAA,oNAAS,EAAC,WAAW,UAAU,GAAG,OAAO;AACnD;AAEO,MAAM,iBAAiB,IAAA,mMAAO,EAAC,mBAAmB;IACvD,IAAI,IAAA,0MAAI,EAAC,MAAM,UAAU,GAAG,aAAa;IACzC,MAAM,IAAA,gNAAO,EAAC,QAAQ;QAAE,QAAQ;IAAI,GAAG,OAAO,GAAG,MAAM;IACvD,SAAS,IAAA,gNAAO,EAAC,WAAW;QAAE,QAAQ;IAAI,GAAG,OAAO;IACpD,MAAM,IAAA,0MAAI,EAAC,QAAQ,OAAO;IAC1B,UAAU,IAAA,gNAAO,EAAC,YAAY;QAAE,QAAQ;IAAG,GAAG,OAAO,GAAG,OAAO,CAAC;IAChE,UAAU,IAAA,gNAAO,EAAC,aAAa,OAAO,CAAC,MAAM,OAAO;IACpD,WAAW,IAAA,oNAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,oNAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAEO,MAAM,iBAAiB,IAAA,2LAAS,EAAC,OAAO,CAAC,EAAE,IAAI,EAAE,GAAK,CAAC;QAC5D,eAAe,KAAK;QACpB,kBAAkB,KAAK;IACzB,CAAC;AAEM,MAAM,kBAAkB,IAAA,2LAAS,EAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,GAAK,CAAC;QAC9D,SAAS,KAAK;QACd,UAAU,KAAK;QACf,eAAe,KAAK;QACpB,iBAAiB,KAAK;IACxB,CAAC;AAEM,MAAM,mBAAmB,IAAA,2LAAS,EAAC,SAAS,CAAC,EAAE,GAAG,EAAE,GAAK,CAAC;QAC/D,OAAO,IAAI,QAAQ;YACjB,QAAQ;gBAAC,QAAQ,OAAO;aAAC;YACzB,YAAY;gBAAC,OAAO,EAAE;aAAC;QACzB;IACF,CAAC;AAEM,MAAM,oBAAoB,IAAA,2LAAS,EAAC,UAAU,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,GAAK,CAAC;QACvE,OAAO,IAAI,QAAQ;YACjB,QAAQ;gBAAC,SAAS,OAAO;aAAC;YAC1B,YAAY;gBAAC,OAAO,EAAE;aAAC;QACzB;QACA,MAAM,IAAI,OAAO;YACf,QAAQ;gBAAC,SAAS,MAAM;aAAC;YACzB,YAAY;gBAAC,MAAM,EAAE;aAAC;QACxB;QACA,kBAAkB,KAAK;IACzB,CAAC;AAEM,MAAM,4BAA4B,IAAA,2LAAS,EAAC,kBAAkB,CAAC,EAAE,GAAG,EAAE,GAAK,CAAC;QACjF,QAAQ,IAAI,iBAAiB;YAC3B,QAAQ;gBAAC,iBAAiB,QAAQ;aAAC;YACnC,YAAY;gBAAC,gBAAgB,EAAE;aAAC;QAClC;QACA,SAAS,IAAI,UAAU;YACrB,QAAQ;gBAAC,iBAAiB,SAAS;aAAC;YACpC,YAAY;gBAAC,SAAS,EAAE;aAAC;QAC3B;QACA,SAAS,IAAI,OAAO;YAClB,QAAQ;gBAAC,iBAAiB,SAAS;aAAC;YACpC,YAAY;gBAAC,MAAM,EAAE;aAAC;QACxB;IACF,CAAC;AAEM,MAAM,yBAAyB,IAAA,2LAAS,EAAC,eAAe,CAAC,EAAE,GAAG,EAAE,GAAK,CAAC;QAC3E,SAAS,IAAI,UAAU;YACrB,QAAQ;gBAAC,cAAc,SAAS;aAAC;YACjC,YAAY;gBAAC,SAAS,EAAE;aAAC;QAC3B;QACA,QAAQ,IAAI,iBAAiB;YAC3B,QAAQ;gBAAC,cAAc,QAAQ;aAAC;YAChC,YAAY;gBAAC,gBAAgB,EAAE;aAAC;QAClC;IACF,CAAC;AAEM,MAAM,qBAAqB,IAAA,2LAAS,EAAC,WAAW,CAAC,EAAE,GAAG,EAAE,GAAK,CAAC;QACnE,SAAS,IAAI,UAAU;YACrB,QAAQ;gBAAC,UAAU,SAAS;aAAC;YAC7B,YAAY;gBAAC,SAAS,EAAE;aAAC;QAC3B;QACA,SAAS,IAAI,OAAO;YAClB,QAAQ;gBAAC,UAAU,SAAS;aAAC;YAC7B,YAAY;gBAAC,MAAM,EAAE;aAAC;QACxB;IACF,CAAC"}},
    {"offset": {"line": 429, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/advising-dashboard-next/src/lib/db/index.ts"],"sourcesContent":["import { drizzle } from 'drizzle-orm/postgres-js';\nimport postgres from 'postgres';\nimport * as schema from './schema';\n\nconst connectionString = process.env.DATABASE_URL!;\n\nconst client = postgres(connectionString);\nexport const db = drizzle(client, { schema });\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEA,MAAM,mBAAmB,QAAQ,GAAG,CAAC,YAAY;AAEjD,MAAM,SAAS,IAAA,sLAAQ,EAAC;AACjB,MAAM,KAAK,IAAA,wMAAO,EAAC,QAAQ;IAAE,QAAA;AAAO"}},
    {"offset": {"line": 448, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/advising-dashboard-next/src/app/api/majors/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { db } from '@/lib/db';\nimport { majors, courses, students } from '@/lib/db/schema';\nimport { eq, sql } from 'drizzle-orm';\n\nexport async function GET() {\n  try {\n    const allMajors = await db.select().from(majors);\n    \n    const result = await Promise.all(allMajors.map(async (major) => {\n      const [courseCount] = await db.select({ count: sql<number>`count(*)` }).from(courses).where(eq(courses.majorId, major.id));\n      const [studentCount] = await db.select({ count: sql<number>`count(*)` }).from(students).where(eq(students.majorId, major.id));\n      \n      return {\n        ...major,\n        courseCount: Number(courseCount?.count || 0),\n        studentCount: Number(studentCount?.count || 0),\n      };\n    }));\n    \n    return NextResponse.json(result);\n  } catch (error) {\n    console.error('Error fetching majors:', error);\n    return NextResponse.json({ error: 'Failed to fetch majors' }, { status: 500 });\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    \n    const { code, name, description, isActive } = body;\n    \n    if (!code || !name) {\n      return NextResponse.json({ error: 'code and name are required' }, { status: 400 });\n    }\n    \n    const result = await db.insert(majors).values({\n      code,\n      name,\n      description: description || null,\n      isActive: isActive !== false,\n    }).returning();\n    \n    return NextResponse.json(result[0], { status: 201 });\n  } catch (error) {\n    console.error('Error creating major:', error);\n    return NextResponse.json({ error: 'Failed to create major' }, { status: 500 });\n  }\n}\n\nexport async function PUT(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const { id, code, name, description, isActive } = body;\n    \n    if (!id) {\n      return NextResponse.json({ error: 'id is required' }, { status: 400 });\n    }\n    \n    const updateData: Record<string, unknown> = {};\n    if (code !== undefined) updateData.code = code;\n    if (name !== undefined) updateData.name = name;\n    if (description !== undefined) updateData.description = description;\n    if (isActive !== undefined) updateData.isActive = isActive;\n    \n    const result = await db.update(majors)\n      .set(updateData)\n      .where(eq(majors.id, id))\n      .returning();\n    \n    if (result.length === 0) {\n      return NextResponse.json({ error: 'Major not found' }, { status: 404 });\n    }\n    \n    return NextResponse.json(result[0]);\n  } catch (error) {\n    console.error('Error updating major:', error);\n    return NextResponse.json({ error: 'Failed to update major' }, { status: 500 });\n  }\n}\n\nexport async function DELETE(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const id = searchParams.get('id');\n    \n    if (!id) {\n      return NextResponse.json({ error: 'id is required' }, { status: 400 });\n    }\n    \n    const [courseCount] = await db.select({ count: sql<number>`count(*)` }).from(courses).where(eq(courses.majorId, id));\n    const [studentCount] = await db.select({ count: sql<number>`count(*)` }).from(students).where(eq(students.majorId, id));\n    \n    if (Number(courseCount?.count) > 0 || Number(studentCount?.count) > 0) {\n      return NextResponse.json({ \n        error: 'Cannot delete major with existing courses or students. Remove them first.' \n      }, { status: 400 });\n    }\n    \n    const result = await db.delete(majors).where(eq(majors.id, id)).returning();\n    \n    if (result.length === 0) {\n      return NextResponse.json({ error: 'Major not found' }, { status: 404 });\n    }\n    \n    return NextResponse.json({ success: true });\n  } catch (error) {\n    console.error('Error deleting major:', error);\n    return NextResponse.json({ error: 'Failed to delete major' }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":"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"}}]
}